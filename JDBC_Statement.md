

# Statement

## Statement	

定义

    封装静态SQL(写死的SQL)

执行语句

    int executeUpdate(String sql):
		执行DML(增删改)和DDL语句
		如果是执行DDL什么都不返回,执行DML返回受影响的行数。
    ResultSet executeQuery(String sql) :
		执行DQL语句，
		返回一个 ResultSet 对象。 


## PreperedStatement

定义

    预编译语句（带有占位符）

参数设置

	void  setXxx(int parameterIndex, Xxx value):  
		xxx表示数据类型,比如:String,int,Long等，
		parameterIndex:设置第几个占位符?(从1开始)，
		value:需要设置的参数值。

语句执行

	int executeUpdate()
	ResultSet executeQuery() 
	作用同于Statement此时不需要传递SQL参数
				

## 区别

好处

	PreparedStatement 
	可以防止SQL注入危机
	可能提高性能(预编译)



# 自增结果

在ResultSet中获取自动生成的主键


Statement:

	st.executeUpdate(sql, Statement.RETURN_GENERATED_KEYS);	//设置需要返回自动生成的主键
	ResultSet rs = st.getGeneratedKeys();		        //获取返回的含主键的结果集
	int executeUpdate(String sql,int autoGeneratedKeys):
	执行SQL
	参数:autoGeneratedKeys,是否需要返回自动生成的主键.常量值:Statement.RETURN_GENERATED_KEYS
	
	ResultSet getGeneratedKeys():获取自动生成的主键
	

			String sql = "insert into t_student (name,age) values('a',22)";
			st = conn.createStatement();
			st.executeUpdate(sql, Statement.RETURN_GENERATED_KEYS);	//设置需要返回自动生成的主键
			ResultSet rs = st.getGeneratedKeys();		        //获取返回的含主键的结果集
			while(rs.next()){
				int id = rs.getInt(1);
				System.out.println(id);
			}


PreparedStatement:

PreparedStatement prepareStatement(String sql, int autoGeneratedKeys)  :创建PreparedStatement对象,并且指定是否需要返回生成的主键. 参数的常量值:Statement.RETURN_GENERATED_KEYS





# 批处理

批量操作(batch)

    当需要成批插入或者更新记录时，可以采用Java的批量更新机制，这一机制允许多条语句一次性提交给数据库批量处理。通常情况下比单独提交处理更有效率.
	批处理就是一批一批的处理，只针对更新（增，删，改）语句，不包括查询。
	


Statement 批处理 ： 一次性可以执行多条sql语句，需要编译多次。


添加sql语句，st.addBatch(sql)  
批量处理sql语句，int[] st.executeBatch()
清除缓存： st.clearBatch();

st = conn.createStatement();
st.addBatch(sql1);  
st.addBatch(sql2);  
st.executeBatch();



PreparedStatement 批处理 ： 执行一条sql语句，编译一次，执行sql语句的参数不同。

添加批量参数：psmt.addBatch()    --添加实际参数，执行之前，需要执行psmt.setXxx()设置实际参数
执行批处理：int[] psmt.executeBatch()
清除缓存：pstm.clearBatch();

st = conn.prepareStatement(sql);

st.setString(1, "aaa");
st.addBatch();
st.setString(1, "bbb");
st.addBatch();
st.executeBatch();
st.clearBatch();










